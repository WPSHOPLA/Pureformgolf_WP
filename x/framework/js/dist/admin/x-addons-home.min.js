tco.addDataSource(xAddonsHome),function(){if(xAddonsHome.modules&&xAddonsHome.notices)for(var e in xAddonsHome.modules){var t=xAddonsHome.modules[e];if(t.notices)for(var o in t.notices){t.notices[o];-1!==xAddonsHome.notices.indexOf(o)&&tco.showNotice(t.notices[o])}}}(),tco.addModule("x-auto-configure-cornerstone",function(e,t,o){function n(){tco.ajax({action:"x_auto_install_cornerstone",done:function(e){s(function(){a(e)})},fail:i})}function s(e){tco.ajax({action:"x_auto_activate_cornerstone",done:"function"==typeof e?e:a,fail:i})}function i(e){if(!e||!e.message){var t={message:o.errors[r]||o.errors.install};e.status&&e.statusText&&(t.errorDetails=e.status+" "+e.statusText),e=t}a(e)}function a(e){if(e){if(e.message)var t=tco.showNotice(e.message);t&&e.errorDetails&&t.find("[data-tco-error-details]").click(function(t){t.preventDefault(),tco.confirm({message:e.errorDetails,acceptBtn:"",declineBtn:o.errorBack,"class":"tco-confirm-error"})})}}var r=e.data("tco-module-state");"install"===r&&n(),"activate"===r&&s()}),tco.addModule("x-validation",function(e,t,o){function n(t){return t.message?void(t.complete?(e.tcoShowMessage(t.message),setTimeout(i,2500)):s(t)):a(t)}function s(t){r.html(t.message),c.html(t.button);var o=650;setTimeout(function(){e.tcoShowMessage("")},2*o),setTimeout(function(){d.addClass("tco-active")},3*o),t.url?(c.attr("href",t.url),t.newTab&&c.attr("target","_blank")):c.attr("href","#"),c.off("click"),t.dismiss&&c.click(function(){d.removeClass("tco-active"),e.tcoRemoveMessage(),setTimeout(function(){l.val("").prop("disabled",!1)},2*o)})}function i(){var e=tco.queryString.parse(window.location.search);delete e["tco-key"],e.notice="validation-complete",window.location.search=tco.queryString.stringify(e)}function a(e){var t=e.message?e.message:e;t.responseText&&(t=t.responseText),s({message:o.error,button:o.errorButton,dismiss:!0}),r.find("[data-tco-error-details]").click(function(e){e.preventDefault(),tco.confirm({message:t,acceptBtn:"",declineBtn:o.errorButton,"class":"tco-confirm-error"})}),console.log(e)}var r=t.message||!1,c=t.button||!1,d=t.overlay||!1,l=t.input||!1,u=t.form||!1;if($preloadKey=t["preload-key"]||!1,r&&c&&d&&l&&u&&$preloadKey){u.on("submit",function(t){t.preventDefault(),l.prop("disabled",!0),e.tcoShowMessage(o.verifying),tco.ajax({action:"x_validation",code:l.val(),done:n,fail:a})});var m=$preloadKey.val();"string"==typeof m&&m.length>1&&(l.val(m),u.submit()),jQuery("body").on("click",'a[data-tco-focus="validation-input"]',function(e){e.preventDefault(),l.focus()})}}),tco.addModule("x-validation-revoke",function(e,t,o){function n(){var e=tco.queryString.parse(tco.queryString.extract(window.location.href));delete e["tco-key"],e.notice="validation-revoked",window.location.search=tco.queryString.stringify(e)}var s=t.revoke||!1;s&&s.click(function(){tco.confirm({message:o.confirm,acceptClass:"tco-btn-nope",acceptBtn:o.accept,declineBtn:o.decline,accept:function(){s.removeAttr("href"),s.html(o.revoking),tco.ajax({action:"x_validation_revoke",done:n,fail:n})}})})}),tco.addModule("x-automatic-updates",function(e,t,o){var n=t["check-now"]||!1,s=t["latest-available"]||!1;n&&s&&(o.latest&&s.html(o.latest),n.find("a").click(function(e){e.preventDefault(),n.html(o.checking),tco.ajax({action:"x_update_check",done:function(e){e.latest&&e.latest!==o.latest?(n.html(o.completeNew),s.html(e.latest)):n.html(o.complete)},fail:function(e){console.warn("X Update Check Error",e),n.html(o.error)}})}))}),tco.addModule("x-customizer-manager",function(e,t,o){function n(e){tco.confirm({message:o.importConfirm,acceptClass:"tco-btn-nope",acceptBtn:o.yep,declineBtn:o.nope,accept:function(){s(e)},decline:function(){a()}})}function s(t){e.tcoShowMessage(o.importBegin);var n=new FileReader;n.onload=function(t){try{i(JSON.parse(n.result))}catch(t){e.tcoShowMessage(o.importError,2500),console.log("X Customizer Manager Import Error",t)}};try{n.readAsText(t)}catch(s){e.tcoShowMessage(o.importError,2500),console.log("X Customizer Manager Import Error",s)}}function i(t){tco.ajax({action:"x_customizer_manager_import","import":t,done:function(t){e.tcoShowMessage(o.importSuccess,2500),a()},fail:function(t){console.warn("X Customizer Import Error",t),e.tcoShowMessage(o.importError,2500),a()}})}function a(){$importFile[0].value="",$importFile[0].type="",$importFile[0].type="file"}function r(){var e=document.createElement("div");return("draggable"in e||"ondragstart"in e&&"ondrop"in e)&&"FormData"in window&&"FileReader"in window}$importForm=t["import-form"]||!1,$importFile=t["import-file"]||!1,$export=t["export"]||!1,$reset=t.reset||!1,$importForm&&$importFile&&$export&&$reset&&($export.on("click",function(){e.tcoShowMessage(o["export"],1500)}),r()?($importForm.on("drag dragstart dragend dragover dragenter dragleave drop",function(e){e.preventDefault(),e.stopPropagation()}).on("dragover dragenter",function(){$importForm.addClass("tco-dragover")}).on("dragleave dragend drop",function(){$importForm.removeClass("tco-dragover")}).on("drop",function(e){n(e.originalEvent.dataTransfer.files[0])}),$importFile[0].onchange=function(){n(this.files[0])}):e.tcoShowMessage(o.useModernBrowser,2500),$reset.click(function(t){t.preventDefault(),tco.confirm({message:o.resetConfirm,acceptClass:"tco-btn-nope",acceptBtn:o.yep,declineBtn:o.nope,accept:function(){e.tcoShowMessage(o.resetBegin),tco.ajax({action:"x_customizer_manager_reset",done:function(t){e.tcoShowMessage(o.resetSuccess,2500)},fail:function(t){console.warn("X Customizer Reset Error",t),e.tcoShowMessage(o.resetError,2500)}})}})}))}),tco.addModule("x-demo-content",function(e,t,o){function n(e,t,o){return jQuery('<option data-demo-type="'+o+'" value="'+e+'">'+t.title+"</option>")}function s(){var e=c.find(":selected"),t="expanded"===e.data("demo-type"),n=t?"expanded_demos":"standard_demos",s=e.val(),i=o.demos[n][s]||{};return i.name=s,i.expanded=t,i}function i(){var e=s();u.attr("href",e.demo_url)}function a(){var e=s();v.init({demo:e.expanded?e.name:e.url},e.expanded)}function r(e){m.prop("disabled",!e)}var c=t.select||!1,d=t["select-group-expanded"]||!1,l=t["select-group-standard"]||!1,u=t["demo-link"]||!1,m=t["setup-button"]||!1;if(c&&d&&l&&u&&m){jQuery.each(o.demos.expanded_demos,function(e,t){d.append(n(e,t,"expanded"))}),jQuery.each(o.demos.standard_demos,function(e,t){l.append(n(e,t,"standard"))}),i(),c.on("change",i),m.click(function(e){e.preventDefault(),tco.confirm({message:o.strings.confirm,acceptClass:"tco-btn-nope",acceptBtn:o.strings.yep,declineBtn:o.strings.nope,accept:a})});var f=jQuery,p=function(){this.$el=f(this.markup),this.$message=this.$el.find(".tco-progress-title"),this.$bar=this.$el.find(".tco-progress-bar-inner")};f.extend(p.prototype,{markup:'<div class="tco-modal-outer"><div class="tco-modal-inner"><div class="tco-progress"><div class="tco-progress-title"></div><div class="tco-progress-bar-outer"><div class="tco-progress-bar-inner"></div></div></div><div class="tco-progress-complete"><div class="tco-progress-complete-icon dashicons dashicons-yes"></div><div class="tco-progress-complete-title">'+o.strings.complete+"</div></div></div></div>",start:function(){this.message(o.strings.start),this.$el.addClass("tco-processing"),f("body").prepend(this.$el),setTimeout(function(){this.$el.addClass("tco-active")}.bind(this),0),this.setProgress(0)},message:function(e){this.$message.html(e)},setProgress:function(e){e=.9*e+.1,this.$bar.css("width",Math.round(100*e)+"%")},simulateProgress:function(){this.message(o.strings.simulated),this.$bar.animate({width:"80%"},250)},complete:function(){this.message("&nbsp;"),this.$bar.animate({width:"100%"},250),setTimeout(function(){this.$el.removeClass("tco-processing"),this.close()}.bind(this),400)},fail:function(e){this.message(e),this.close()},close:function(){setTimeout(function(){this.$el.removeClass("tco-active")}.bind(this),1500),setTimeout(function(){this.$el.detach(),this.setProgress(0),this.message("")}.bind(this),2e3)}});var g=function(){};f.extend(g.prototype,{init:function(e,t){return this.demoData=e,this.demoData.action=t?"x_demo_importer":"x_demo_content_setup",this.demoData.attempts=1,this.demoData._tco_nonce=tcoCommon._tco_nonce,t?(this.demoData.session="s_"+Math.round((new Date).getTime()+100*Math.random()),h.start(),r(!1),void this.acknowledge({data:{},first:!0})):this.runStandard()},runStandard:function(){h.start(),h.simulateProgress(),r(!1),this.standardProcess(function(e){return e.success===!1?this.failure(e.data.message,e):(h.complete(),void r(!0))}.bind(this))},standardProcess:function(e){jQuery.post(ajaxurl,this.demoData,e).fail(function(t){return h.message(this.timeOutMessage(this.demoData.attempts++)),this.demoData.attempts>=25?this.failure(t.strings.failure,t):void this.standardProcess(e)}.bind(this))},acknowledge:function(e){if(e.data||e.first){if(this.demoData.attempts=0,0==e.success)return this.failure(e.data.message,e.data);if(e.data.message&&h.message(e.data.message),e.data.debug_message&&o.strings.debug&&console.log("X Demo Debug",e.data.debug_message,e.data.debug||null),e.data.completion&&e.data.completion===!0)return e.data.debug&&o.strings.debug&&console.log(e.data.debug),this.complete();e.data.completion&&h.setProgress(e.data.completion.ratio)}else if(h.message(this.timeOutMessage(this.demoData.attempts++)),this.demoData.attempts>25)return this.failure(o.strings.failure,e);setTimeout(function(){jQuery.post(ajaxurl,this.demoData).always(this.acknowledge.bind(this))}.bind(this),40*this.demoData.attempts)},complete:function(){h.complete(),r(!0)},failure:function(e,t){h.fail(e),r(!0),console.error("X Demo Importer failure",t||{})},timeOutMessage:function(e){return e>20?o.strings.timeout3:e>10?o.strings.timeout2:o.strings.timeout1}});var h=new p,v=new g}}),tco.addModule("x-extension",function(e,t,o){function n(){d.prop("disabled",!0),window._xExtensionQueue.running?(e.tcoShowMessage("Waiting to install&hellip;"),window._xExtensionQueue.queue.unshift(i)):(i(),window._xExtensionQueue.running=!0)}function s(){if(0<window._xExtensionQueue.queue.length){var e=window._xExtensionQueue.queue.pop();e()}else window._xExtensionQueue.running=!1}function i(){e.tcoShowMessage("Installing&hellip;"),tco.ajax({action:"x_extensions_installer",plugin:u.plugin,"package":u["package"],done:a,fail:r})}function a(t){console.log("Installed",t),c(),e.tcoRemoveMessage(!1,function(){e.removeClass("tco-extension-not-installed").addClass("tco-extension-installed")}),s()}function r(t){var n=t.message?t.message:t;n.responseText&&(n=n.responseText),e.tcoShowErrorMessage(o.error,n),console.log(t),s()}function c(){d.off("click",n),d.html(o.installed).attr("href",o.pluginsURI)}var d=t.install||!1,l=e.attr("id"),u="undefined"!=typeof e.data("x-extension")?o.extensions[l]:o.approvedPlugins[l];if(d&&u){if(u.activated)return void d.html(o.activated).addClass("tco-btn-yep tco-btn-disabled");if(u.installed)return void c();window._xExtensionQueue||(window._xExtensionQueue={running:!1,queue:[]}),d.on("click",n)}});